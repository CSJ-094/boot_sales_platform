<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.LoginDAO">

    <!-- 로그인 여부 확인 -->
    <select id="loginYn" resultType="com.boot.dto.LoginDTO">
    	select member_pw AS memberPw, member_id AS memberId, member_name AS memberName from user_db where member_id=#{memberId}
    </select>
        
    <!-- 회원 가입 -->
<!--    <insert id="write">-->
<!--	    insert into user_db(member_id, member_pw, member_name, member_email, member_phone, member_zipcode, member_addr1, member_addr2) -->
<!--        values(#{memberId},#{memberPw},#{memberName},#{memberEmail},#{memberPhone},#{memberZipcode},#{memberAddr1},#{memberAddr2})-->
<!--    </insert>-->
    <insert id="write">
        insert into user_db
            (member_id,
            member_pw,
            member_name,
            member_email,
            member_phone,
            member_zipcode,
            member_addr1, member_addr2,
            social_login
        )
        values(
            #{memberId},
            #{memberPw, jdbcType=VARCHAR},
            #{memberName},#{memberEmail},
            #{memberPhone, jdbcType=VARCHAR},
            #{memberZipcode},
            #{memberAddr1},#{memberAddr2},
            #{socialLogin}
        )
    </insert>
    
    <!-- 아이디 중복 확인 (ID: idCheck) -->
    <select id="idCheck" resultType="com.boot.dto.LoginDTO">
    	select member_id AS memberId from user_db where member_id=#{memberId}
    </select>
    
    <!-- 이메일 중복 확인 (ID: emailCheck) -->
    <select id="emailCheck" resultType="com.boot.dto.LoginDTO">
    	select member_email AS memberEmail from user_db where member_email=#{memberEmail}
    </select>
    
    <!-- 아이디 찾기 (추가: 이름과 이메일로 검색) -->
    <select id="findId" resultType="com.boot.dto.LoginDTO">
        select member_id AS memberId, member_email AS memberEmail from user_db 
        where member_name = #{memberName} and member_email = #{memberEmail}
    </select>
    
    <!-- 비밀번호 찾기 (추가: 아이디, 이름, 이메일로 검색) -->
    <select id="findPw" resultType="com.boot.dto.LoginDTO">
        select member_id AS memberId, member_name AS memberName, member_pw AS memberPw, member_email AS memberEmail from user_db 
        where member_id = #{memberId} and member_name = #{memberName} and member_email = #{memberEmail}
    </select>
    
    <!-- 비밀번호 업데이트 (임시 비밀번호 발급 시 사용) -->
    <update id="updatePw">
        update user_db set member_pw = #{memberPw} where member_id = #{memberId}
    </update>

    <!--   kakao용 이메일 확인-->
    <select id="findByEmail" resultType="com.boot.dto.LoginDTO">
        SELECT *
        FROM user_db
        WHERE member_email = #{email}
    </select>

    <delete id="deleteUser" parameterType="string">
        DELETE FROM USER_DB WHERE MEMBER_ID = #{memberId}
    </delete>

</mapper>
